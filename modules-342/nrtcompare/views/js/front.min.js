$(document).ready(function(){function e(){$(".js-compare").each(function(){var t=$(this),a=0;t.closest(".js-product-miniature").length?a=t.closest(".js-product-miniature").data("id-product"):$("#product_page_product_id").length&&(a=$("#product_page_product_id").val()),t.attr("data-id-product",a),t.attr("data-id-product-attribute",0),opCompare.ids.includes(a+"-0")?(t.removeClass("js-compare-add").addClass("added"),t.text(opCompare.alert.view),void 0!==$(this).attr("data-original-title")&&!1!==$(this).attr("data-original-title")?t.attr("data-original-title",opCompare.alert.view):t.attr("title",opCompare.alert.view)):(t.addClass("js-compare-add").removeClass("added"),t.text(opCompare.alert.add),void 0!==$(this).attr("data-original-title")&&!1!==$(this).attr("data-original-title")?t.attr("data-original-title",opCompare.alert.add):t.attr("title",opCompare.alert.add)),t.addClass("js-compare-btn-"+a+"-0")}),$(".js-compare-nb").text(opCompare.ids.length)}e(),$("body").on("show.bs.modal",".quickview",function(){e()}),prestashop.on("updatedProductList",function(t){e()}),prestashop.on("updatedProduct",function(t){e()}),prestashop.on("updatedProductAjax",function(t){e()}),$("body").on("click",".js-compare-add",function(t){prestashop.emit("clickCompareAdd",{dataset:this.dataset,self:this}),t.preventDefault()}),$("body").on("click",".js-compare-remove",function(t){prestashop.emit("clickCompareRemove",{dataset:this.dataset}),t.preventDefault()}),$("body").on("click",".js-compare-remove-all",function(t){prestashop.emit("clickCompareRemoveAll",{dataset:this.dataset}),t.preventDefault()}),prestashop.on("clickCompareAdd",function(a){var t;$(".js-compare-btn-"+a.dataset.idProduct+"-"+a.dataset.idProductAttribute).hasClass("loading")||(t={process:"add",ajax:1,idProduct:a.dataset.idProduct,idProductAttribute:a.dataset.idProductAttribute},$(".js-compare-btn-"+a.dataset.idProduct+"-"+a.dataset.idProductAttribute).addClass("loading"),$.post(opCompare.actions,t,null,"json").then(function(t){opCompare.enabled_notices&&t.notices&&($(t.notices).find(".ax-n-success").length?toastr.success(t.notices):$(t.notices).find(".ax-n-info").length?toastr.info(t.notices):toastr.error(t.notices)),opCompare.ids=t.productsIds,$(".js-compare-btn-"+a.dataset.idProduct+"-"+a.dataset.idProductAttribute).removeClass("loading"),e()}).fail(function(t){prestashop.emit("handleError",{eventType:"clickCompareAdd",resp:t})}))}),prestashop.on("clickCompareRemove",function(a){var t;$(".js-compare-remove-"+a.dataset.idProduct+"-"+a.dataset.idProductAttribute).hasClass("loading")||(t={process:"remove",ajax:1,idProduct:a.dataset.idProduct,idProductAttribute:a.dataset.idProductAttribute},$(".js-compare-remove-"+a.dataset.idProduct+"-"+a.dataset.idProductAttribute).addClass("loading"),$.post(opCompare.actions,t,null,"json").then(function(t){$(".js-compare-"+a.dataset.idProduct+"-"+a.dataset.idProductAttribute).remove(),opCompare.ids=t.productsIds,e(),0==opCompare.ids.length&&($("#js-compare-table").remove(),$("#js-compare-warning").show())}).fail(function(t){prestashop.emit("handleError",{eventType:"clickCompareRemove",resp:t})}))}),prestashop.on("clickCompareRemoveAll",function(t){$(".js-compare-remove-all").hasClass("loading")||($(".js-compare-remove-all").addClass("loading"),$.post(opCompare.actions,{process:"removeAll",ajax:1},null,"json").then(function(t){opCompare.ids=t.productsIds,e(),$("#js-compare-table").remove(),$("#js-compare-warning").show()}).fail(function(t){prestashop.emit("handleError",{eventType:"clickCompareRemoveAll",resp:t})}))})});