/**
 * AxonCreator - Website Builder
 *
 * NOTICE OF LICENSE
 *
 * @author    axonviz.com <support@axonviz.com>
 * @copyright 2021 axonviz.com
 * @license   You can not resell or redistribute this software.
 *
 * https://www.gnu.org/licenses/gpl-3.0.html
 */
var AxpsSearchModule;!function(c){"use strict";AxpsSearchModule={init:function(){this.mdSearch()},mdSearch:function(){c("body").on("shown.bs.modal","#search-popup",function(){c("#search-popup").find("input[name=s]").focus()});function a(){c("form.has-ajax-search").each(function(){var a,e,r,n,s,i=c(this);i.hasClass("fs-initialized")||(i.addClass("fs-initialized"),a='<div class="view-all-results view-all-products"><span>'+opSearch.all_results_product+"</span></div>",e=i.attr("action"),r=parseInt(opSearch.count),n="cart_default",s=i.closest(".search-wrapper").find(".search-results"),i.removeClass("has-ajax-search"),void 0!==opSearch.imageType&&""!=opSearch.imageType&&(n=opSearch.imageType),""!=opSearch.search_string&&i.find("input[name=s]").val(opSearch.search_string),s.on("click",".view-all-products",function(){i.submit()}),i.find("input[name=s]").devbridgeAutocomplete({serviceUrl:e,appendTo:s,type:"POST",dataType:"json",paramName:"s",minChars:3,params:{resultsPerPage:r,nrtAjax:1},onSelect:function(e){void 0!==e.permalink&&0<e.permalink.length&&(c("body").hasClass("product-id-"+e.id)?location.reload():window.location.href=e.permalink)},onSearchStart:function(e){i.addClass("search-loading")},beforeRender:function(e){c(e).find(".search-divider-text").parent().addClass("search-divider"),c(e).find(".no-result").parent().addClass("search-no-result"),c(e).find(".view-all-products").parent().replaceWith(a)},onSearchComplete:function(e,a){i.removeClass("search-loading")},transformResult:function(e){var i=[];return i.push({value:"",divider:opSearch.divider}),0<e.products.length?(e.products.forEach(function(e){var a=(e.has_discount?'<span class="regular-price">'+e.regular_price+"</span> ":"")+'<span class="price">'+e.price+"</span>",r="",r=(e.cover&&void 0!==e.cover.bySize[n].url?e.cover:prestashop.urls.no_picture_image).bySize[n].url,s=opSearch.sku+" "+(e.reference||"N/A");i.push({id:e.id_product,value:e.name,permalink:e.url,price:e.show_price?a:"",thumbnail:'<img class="img-responsive" src="'+r+'" alt="" title="">',sku:s})}),i.push({value:"",view_all_products:!0,permalink:""})):i.push({value:opSearch.noProducts,no_found:!0,permalink:""}),{suggestions:i}},formatResult:function(e,a){var r="("+(a="&"===a?"&#038;":a).replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")",a="";return e.divider&&(a+=' <h5 class="search-divider-text">'+e.divider+"</h5>"),e.thumbnail&&(a+=' <div class="search-thumb">'+e.thumbnail+"</div>"),e.value&&(a+='<h4 class="search-title">'+e.value.replace(new RegExp(r,"gi"),"<strong>$1</strong>").replace(/&lt;(\/?strong)&gt;/g,"<$1>")+"</h4>"),e.no_found&&(a='<div class="no-result">'+e.value+"</div>"),e.view_all_products&&(a='<div class="view-all-products"></div>'),e.sku&&(a+=' <div class="search-sku">'+e.sku+"</div>"),e.price&&(a+=' <div class="search-price">'+e.price+"</div>"),a}}),c("body").on("click",function(e){e=e.target;c(e).is(".search-wrapper")||c(e).parents().is(".search-wrapper")||i.find("input[name=s]").devbridgeAutocomplete("hide")}))})}a(),prestashop.on("updatedProductList",function(e){a()})}}}(jQuery),jQuery(document).ready(function(){AxpsSearchModule.init()});