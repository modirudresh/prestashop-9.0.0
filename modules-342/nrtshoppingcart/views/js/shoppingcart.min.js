$(document).ready(function(){$("body").on("hidden.bs.modal","#nrtshoppingcart-modal",function(t){prestashop.emit("updateProduct",{reason:t.currentTarget.dataset,event:t})}),prestashop.buy_now_cart=!1,$("body").on("click","[data-button-action=add-to-cart], .js-add-to-cart",function(t){0<$(this).closest("form").find("input[name=qty]").val()&&($(this).hasClass("js-buy-now")&&(prestashop.buy_now_cart=!0),$(this).addClass("loading").prop("disabled",!0))}),$("body").on("click",".js-add-to-cart",function(t){t.preventDefault();const a=$(t.currentTarget.form);a.find('input[name="token"]').val(prestashop.static_token);var r=`${a.serialize()}&add=1&action=update`,t=a.attr("action");$.post(t,r,null,"json").then(t=>{t.hasError?prestashop.emit("handleError",{eventType:"addProductToCart",resp:t}):prestashop.emit("updateCart",{reason:{idProduct:t.id_product,idProductAttribute:t.id_product_attribute,idCustomization:t.id_customization,linkAction:"add-to-cart",cart:t.cart},resp:t})}).fail(t=>{prestashop.emit("handleError",{eventType:"addProductToCart",resp:t})})}),$("body").on("click",'[data-link-action="delete-from-cart"], [data-link-action="remove-voucher"]',function(t){$("body").addClass("cart-processing")}),$("body").on("click",'[data-link-action="delete-all-cart"]',function(t){var a=opShoppingCart.ajax,r={action:"delete-all-cart"};$("body").addClass("cart-processing"),$.post(a,r).then(function(t){$('[data-link-action="delete-from-cart"]').first().click()})}),$(".js-cart-nbr").text(prestashop.cart.products_count),$(".js-cart-amount").text(prestashop.cart.subtotals.products.value),prestashop.on("updatedCart",function(t){0<$(t.resp.cart_detailed).find(".empty-products").length?($("body").addClass("cart-is-empty"),void 0!==prestashop.page.page_name&&"checkout"==prestashop.page.page_name&&location.assign(prestashop.urls.pages.index)):$("body").removeClass("cart-is-empty")}),prestashop.on("handleError",function(t){$('[data-button-action="add-to-cart"], .js-add-to-cart').removeClass("loading").prop("disabled",!1),t&&void 0!==t.resp&&t.resp.errors&&void 0!==prestashop.page.page_name&&"cart"!=prestashop.page.page_name&&"checkout"!=prestashop.page.page_name&&toastr.error(Array.isArray(t.resp.errors)?t.resp.errors.join("<br/>"):t.resp.errors)}),prestashop.on("updateCart",function(t){$('[data-button-action="add-to-cart"], .js-add-to-cart').removeClass("loading").prop("disabled",!1),t&&void 0!==t.resp&&t.resp.errors&&void 0!==prestashop.page.page_name&&"cart"!=prestashop.page.page_name&&"checkout"!=prestashop.page.page_name&&toastr.error(Array.isArray(t.resp.errors)?t.resp.errors.join("<br/>"):t.resp.errors)}),prestashop.on("updateCart",function(t){var a=opShoppingCart.ajax,r={};t&&t.reason&&void 0!==t.resp&&!t.resp.hasError&&(r={id_customization:t.reason.idCustomization,id_product_attribute:t.reason.idProductAttribute,id_product:t.reason.idProduct,action:t.reason.linkAction}),prestashop.buy_now_cart||!opShoppingCart.has_ajax&&"add-to-cart"==t.reason.linkAction?location.assign(prestashop.urls.pages.order):($("body").addClass("cart-processing"),t&&t.resp&&t.resp.hasError&&prestashop.emit("showErrorNextToAddtoCartButton",{errorMessage:t.resp.errors.join("<br/>")}),$.post(a,r).then(function(t){$("body").removeClass("cart-processing"),$('[data-button-action="add-to-cart"], .js-add-to-cart').removeClass("loading").prop("disabled",!1),$(".js-shopping-cart").replaceWith($(t.canvas).find(".js-shopping-cart")),$(".js-cart-canvans-title").replaceWith($(t.canvas).find(".js-cart-canvans-title")),$(".js-cart-nbr").replaceWith($(t.preview).find(".js-cart-nbr")),$(".js-cart-amount").replaceWith($(t.preview).find(".js-cart-amount")),t.modal||t.notices?"canvas"==opShoppingCart.action_after?(prestashop.emit("show_canvas_widget",$("#canvas-mini-cart")),prestashop.emit("updateProduct",{reason:opShoppingCart.action_after,resp:t})):"modal"==opShoppingCart.action_after?($("#nrtshoppingcart-modal-content").html(t.modal),$("#nrtshoppingcart-modal").modal("show")):($(t.notices).find(".ax-n-success").length?toastr.success(t.notices):$(t.notices).find(".ax-n-info").length?toastr.info(t.notices):toastr.error(t.notices),prestashop.emit("updateProduct",{reason:opShoppingCart.action_after,resp:t})):prestashop.emit("updateProduct",{reason:opShoppingCart.action_after,resp:t}),prestashop.emit("updateCarted",null)}).fail(function(t){$("body").removeClass("cart-processing"),$('[data-button-action="add-to-cart"], .js-add-to-cart').removeClass("loading").prop("disabled",!1),prestashop.emit("handleError",{eventType:"updateShoppingCart",resp:t})}))})});